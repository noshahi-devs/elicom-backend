<div class="product-detail-container">
  <div class="container">
    <!-- Breadcrumb Navigation -->
    <nav class="breadcrumb-nav">
      <div class="breadcrumb-wrapper">
        <a class="breadcrumb-item" routerLink="/">Home</a>
        <i class="pi pi-chevron-right breadcrumb-separator"></i>
        <a class="breadcrumb-item" routerLink="/categories">Categories</a>
        <i class="pi pi-chevron-right breadcrumb-separator"></i>
        <span class="breadcrumb-item active">{{ product?.name }}</span>
      </div>
    </nav>

    <!-- Main Product Section -->
    <div class="product-main-section">
      <div class="product-visual-section">
        <!-- Product Images/3D Viewer -->
        <div class="product-visual-container">
          <!-- Images View -->
          <div class="images-view">
            <div class="main-image-container">
              <img [src]="product?.image || 'https://placehold.co/600x400/f85606/ffffff?text=Product+Image'"
                [alt]="product?.name || 'Product'" class="main-product-image">
              <div class="image-overlay">
                <button class="overlay-btn"><i class="pi pi-search-plus"></i></button>
                <button class="overlay-btn"><i class="pi pi-expand"></i></button>
              </div>
            </div>
            <div class="thumbnail-strip" *ngIf="product?.images && (product?.images?.length || 0) > 1">
              <div class="thumbnail" *ngFor="let img of product?.images; let i = index"
                [class.active]="product?.image === img" (click)="product && selectImage(product, i)">
                <img [src]="img" [alt]="'Product thumbnail ' + i">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="product-info-section">
        <!-- Product Header -->
        <div class="product-header">
          <div class="product-metadata-top">
            <span class="sku-label" *ngIf="product?.specifications?.[0]">SKU: {{ product?.specifications?.[0]?.value
              }}</span>
            <span class="verified-purchase"><i class="pi pi-check-circle"></i> Verified Sourcing Item</span>
          </div>
          <h1 class="product-title">{{ product?.name }}</h1>
          <div class="price-section">
            <div class="price-row">
              <span class="price-label">Supplier Price:</span>
              <span class="current-price">${{ product?.price }}</span>
              <span class="original-price" *ngIf="product?.originalPrice">${{ product?.originalPrice }}</span>
            </div>
          </div>
        </div>

        <!-- Product Description -->
        <div class="product-description">
          <p>{{ product?.description }}</p>
        </div>

        <!-- Product Options -->
        <div class="product-options">
          <div class="option-group" *ngIf="sizes.length > 0">
            <label class="option-label">Size:</label>
            <div class="size-options">
              <button class="size-btn" *ngFor="let size of sizes" [class.active]="selectedSize === size"
                (click)="selectedSize = size">{{ size }}</button>
            </div>
          </div>

          <div class="option-group">
            <label class="option-label">Color:</label>
            <div class="color-options" *ngIf="colors.length > 0">
              <div class="color-option" *ngFor="let color of colors" [style.backgroundColor]="color"
                [class.active]="selectedColor === color" (click)="selectedColor = color"></div>
            </div>
            <div class="option-info" *ngIf="colors.length === 0">Standard Color</div>
          </div>

          <div class="option-group quantity-group">
            <label class="option-label">Quantity:</label>
            <div class="quantity-selector">
              <button class="quantity-btn" (click)="decreaseQuantity()">
                <i class="pi pi-minus"></i>
              </button>
              <input type="number" class="quantity-input" [(ngModel)]="quantity" min="1" max="10">
              <button class="quantity-btn" (click)="increaseQuantity()">
                <i class="pi pi-plus"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="product-actions">
          <button class="btn-primary-action" (click)="buyNow()">
            <i class="pi pi-bolt"></i>
            <span>Buy Now</span>
          </button>
          <button class="btn-secondary-action" (click)="addToCart()">
            <i class="pi pi-shopping-cart"></i>
            <span>Add to Cart</span>
          </button>
          <button class="btn-wishlist" (click)="addToWishlist()">
            <i class="pi pi-heart"></i>
          </button>
        </div>

        <!-- Product Features (Seller Optimized) -->
        <div class="product-features">
          <div class="feature-item">
            <i class="pi pi-box feature-icon"></i>
            <div class="feature-content">
              <span class="feature-title">Bulk Sourcing</span>
              <span class="feature-desc">Optimized for high-volume orders</span>
            </div>
          </div>
          <div class="feature-item">
            <i class="pi pi-verified feature-icon"></i>
            <div class="feature-content">
              <span class="feature-title">Authentic Origin</span>
              <span class="feature-desc">Sourced directly from verified vendors</span>
            </div>
          </div>
          <div class="feature-item">
            <i class="pi pi-shield feature-icon"></i>
            <div class="feature-content">
              <span class="feature-title">Prime Protection</span>
              <span class="feature-desc">Secure transactions and logistics</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Product Details Tabs -->
    <div class="product-details-section">
      <div class="details-tabs">
        <button class="details-tab" [class.active]="activeTab === 'description'" (click)="activeTab = 'description'">
          <i class="pi pi-info-circle"></i>
          <span>Product Overview</span>
        </button>
        <button class="details-tab" [class.active]="activeTab === 'specifications'"
          (click)="activeTab = 'specifications'">
          <i class="pi pi-list"></i>
          <span>Specifications</span>
        </button>
      </div>

      <div class="details-content">
        <!-- Product Details Tab -->
        <div class="tab-pane" *ngIf="activeTab === 'description'">
          <div class="product-details-content">
            <div class="details-header">
              <h3>Product Description</h3>
              <p>{{ product?.fullDescription || product?.description }}</p>
            </div>

            <!-- Product Gallery -->
            <div class="product-gallery" *ngIf="galleryItems.length > 0">
              <h4>Product Gallery</h4>
              <div class="gallery-grid">
                <div class="gallery-item" *ngFor="let item of galleryItems">
                  <img [src]="item.image" [alt]="item.title">
                  <div class="gallery-overlay">
                    <span>{{ item.title }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Key Features -->
            <div class="key-features" *ngIf="keyFeatures.length > 0">
              <h4>Key Features</h4>
              <div class="features-grid">
                <div class="feature-card" *ngFor="let feature of keyFeatures">
                  <i class="pi" [class]="feature.icon"></i>
                  <span>{{ feature.text }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Specifications Tab -->
        <div class="tab-pane" *ngIf="activeTab === 'specifications'">
          <div class="specifications-content">
            <h3>Technical Specifications</h3>
            <div class="spec-grid">
              <div class="spec-item" *ngFor="let spec of specs">
                <div class="spec-label">{{ spec.key }}</div>
                <div class="spec-value">{{ spec.value }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Related Products Section -->
    <div class="related-products-section" *ngIf="relatedProducts.length > 0">
      <div class="section-header">
        <h3>You Might Also Like</h3>
        <a href="#" class="view-all-btn" [class.loading]="isLoadingMore"
          (click)="toggleViewAll(); $event.preventDefault()">
          <span *ngIf="!showAllProducts">View All Products</span>
          <span *ngIf="showAllProducts">Show Less</span>
        </a>
      </div>

      <div class="related-products-grid">
        <div class="related-product-card" *ngFor="let p of relatedProducts" (click)="onRelatedProductClick(p)">
          <div class="related-product-image">
            <!-- Image Carousel -->
            <div class="image-carousel">
              <div class="carousel-container">
                <img [src]="p.image" [alt]="p.name" class="main-carousel-image">
                <div class="carousel-thumbnails" *ngIf="p.images && p.images.length > 1">
                  <div class="thumbnail-dot" *ngFor="let img of p.images; let i = index" [class.active]="i === 0"
                    (click)="$event.stopPropagation(); selectImage(p, i)">
                    <img [src]="img" [alt]="'Thumbnail ' + (i + 1)">
                  </div>
                </div>
              </div>
            </div>

            <div class="discount-badge" *ngIf="p.discount">{{ p.discount }}% OFF</div>
          </div>

          <div class="related-product-info">
            <h6 class="related-product-name">{{ p.name }}</h6>
            <div class="related-product-price">
              <span class="current-price">${{ p.price }}</span>
              <span class="original-price" *ngIf="p.originalPrice">${{ p.originalPrice }}</span>
            </div>
            <div class="related-product-rating">
              <span class="sku-mini">SKU: {{ p.sku }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Show More/Less Section -->
      <div class="text-center" *ngIf="!showAllProducts && relatedProducts.length >= maxProductsToShow">
        <button class="btn-show-more" (click)="loadAllRelatedProducts()">
          <span *ngIf="!isLoadingMore">Show More Products</span>
          <span *ngIf="isLoadingMore">Loading...</span>
          <i class="pi pi-chevron-down" *ngIf="!isLoadingMore"></i>
          <i class="pi pi-spin pi-spinner" *ngIf="isLoadingMore"></i>
        </button>
      </div>
    </div>
  </div>
</div>