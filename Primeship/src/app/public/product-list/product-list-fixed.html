<div class="product-list-container">
  <div class="container">
    <!-- Beautiful Category Header -->
    <div class="category-header" *ngIf="categoryTitle">
      <div class="category-hero">
        <div class="category-image-overlay"></div>
        <img [src]="categoryImage" [alt]="categoryTitle" class="category-bg-image">
        <div class="category-content">
          <div class="category-breadcrumb">
            <a href="/home" class="breadcrumb-link">Home</a>
            <span class="breadcrumb-separator">›</span>
            <span class="breadcrumb-current">{{ categoryTitle }}</span>
          </div>
          <h1 class="category-title">{{ categoryTitle }}</h1>
          <p class="category-description">{{ categoryDescription }}</p>
          <div class="category-stats">
            <div class="stat-item">
              <span class="stat-number">{{ filteredProducts.length }}</span>
              <span class="stat-label">Products</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">5★</span>
              <span class="stat-label">Premium Quality</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">24h</span>
              <span class="stat-label">Fast Shipping</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filters Section -->
    <div class="filters-section">
      <div class="filters-row">
        <div class="filter-item">
          <select class="form-select" formControlName="sortBy">
            <option value="featured">Sort by: Featured</option>
            <option value="price-low">Price: Low to High</option>
            <option value="price-high">Price: High to Low</option>
            <option value="newest">Newest First</option>
            <option value="rating">Best Rating</option>
          </select>
        </div>
        <div class="filter-item">
          <select class="form-select" formControlName="category">
            <option value="">All Categories</option>
            <option value="electronics">Electronics</option>
            <option value="fashion">Fashion</option>
            <option value="home-living">Home & Living</option>
            <option value="beauty">Beauty</option>
            <option value="sports">Sports</option>
            <option value="accessories">Accessories</option>
          </select>
        </div>
        <div class="filter-item">
          <div class="price-range">
            <input type="number" class="form-control" placeholder="Min Price" formControlName="minPrice">
          </div>
        </div>
        <div class="filter-item">
          <div class="price-range">
            <input type="number" class="form-control" placeholder="Max Price" formControlName="maxPrice">
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Layout -->
    <div class="main-content-layout">
      <!-- Left Sidebar -->
      <div class="left-sidebar">
        <div class="sidebar-filters">
          <!-- Categories Section -->
          <h5>Categories</h5>
          <div class="category-list">
            <div class="form-check" *ngFor="let cat of categoriesWithCount">
              <input type="checkbox" [id]="'cat-' + cat.id" class="form-check-input"
                [checked]="currentCategorySlug === cat.slug" (change)="onCategoryToggle(cat)">
              <label [for]="'cat-' + cat.id" class="form-check-label">
                {{ cat.name }}
                <span class="category-count">{{ cat.count }}</span>
              </label>
            </div>
            <div class="no-cats" *ngIf="categoriesWithCount.length === 0">
              <p class="text-muted small">No categories found</p>
            </div>
          </div>

          <!-- Price Range Section -->
          <div class="price-filter" [formGroup]="filtersForm">
            <h5>Price Range</h5>
            <div class="price-range-container">
              <div class="price-display">
                <span>Min: $<input type="number" class="min-price" formControlName="minPrice"></span>
                <span>Max: $<input type="number" class="max-price" formControlName="maxPrice"></span>
              </div>
              <input type="range" min="0" max="250000" step="1000" class="form-range" formControlName="maxPrice">
              <div class="price-labels">
                <span class="min-label">$0</span>
                <span class="max-label">$250,000</span>
              </div>
            </div>
          </div>

          <!-- Featured Categories Section -->
          <div class="featured-categories">
            <h5>Featured</h5>
            <div class="featured-grid">
              <div class="featured-item" *ngFor="let cat of categories.slice(0, 4)" (click)="onCategoryToggle(cat)">
                <img [src]="cat.imageUrl || '/assets/images/61+DG4Np+zL._AC_SX425_.jpg'" [alt]="cat.name"
                  (error)="handleImageError($event, cat.name)">
                <span>{{ cat.name }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Body - Category Related Products -->
      <div class="main-content">
        <!-- Category Title Section -->
        <div class="category-title-section" *ngIf="categoryTitle">
          <div class="category-header-content">
            <h2 class="category-display-title">{{ categoryTitle }}</h2>
            <p class="category-display-description">{{ categoryDescription }}</p>
            <div class="category-stats-display">
              <span class="product-count">{{ filteredProducts.length }} Products</span>
              <span class="category-badge">Premium Quality</span>
              <span class="shipping-badge">Fast Shipping</span>
            </div>
          </div>
        </div>

        <!-- Products Grid -->
        <div class="products-grid">
          <!-- Loading State -->
          <div class="text-center py-5" *ngIf="isLoading">
            <i class="pi pi-spin pi-spinner" style="font-size: 2rem; color: var(--primary)"></i>
            <p class="mt-2">Loading products...</p>
          </div>

          <!-- Empty State -->
          <div class="text-center py-5" *ngIf="!isLoading && filteredProducts.length === 0">
            <i class="pi pi-search" style="font-size: 3rem; color: #cbd5e1"></i>
            <h4 class="mt-3">No products found</h4>
            <p class="text-muted">Try adjusting your filters or search terms.</p>
            <button class="btn btn-outline-primary mt-2" (click)="clearFilters()">Clear All Filters</button>
          </div>

          <div class="row" *ngIf="!isLoading">
            <div class="col-md-4 col-sm-6 mb-4" *ngFor="let product of filteredProducts">
              <div class="product-card" (click)="onProductClick(product)">
                <div class="product-image">
                  <img [src]="product.image" [alt]="product.name" (error)="handleImageError($event, product.name)">
                  <div class="product-actions">
                    <button class="btn btn-sm btn-outline-primary" (click)="$event.stopPropagation()">Quick
                      View</button>
                    <button class="btn btn-sm btn-outline-danger" (click)="$event.stopPropagation()">Wishlist</button>
                  </div>
                  <div class="discount-badge" *ngIf="product.discount">
                    {{ product.discount }}% OFF
                  </div>
                </div>
                <div class="product-info">
                  <h6 class="product-name">{{ product.name }}</h6>
                  <div class="product-price">
                    <span class="current-price">${{ product.price | number:'1.0-0' }}</span>
                    <span class="original-price" *ngIf="product.originalPrice">${{ product.originalPrice |
                      number:'1.0-0' }}</span>
                  </div>
                  <div class="product-rating">
                    <span class="stars">★★★★★</span>
                    <span class="rating-count">({{ product.reviewCount }})</span>
                  </div>
                  <button class="btn btn-primary btn-sm w-100" (click)="$event.stopPropagation()">Add to Cart</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Pagination Info (Simplified for now) -->
        <div class="pagination-info" *ngIf="filteredProducts.length > 0">
          <span class="total-items">Showing {{ filteredProducts.length }} products</span>
        </div>
      </div>
    </div>
  </div>
</div>