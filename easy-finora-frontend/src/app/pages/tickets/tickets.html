<div class="page-container">
    <div class="page-header">
        <h1>Support Tickets</h1>
        <button class="btn-3d" (click)="toggleCreate()">
            {{ isCreating ? 'Close Form' : '+ Create New Ticket' }}
        </button>
    </div>

    <div *ngIf="isCreating" class="ticket-create-form"
        style="background: var(--bg-surface, #fff); padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
        <h3 style="margin-top: 0;">New Ticket Details</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
            <div>
                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Title</label>
                <input type="text" [(ngModel)]="newTicket.title" placeholder="Issue Subject"
                    style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
            </div>
            <div>
                <label style="display: block; margin-bottom: 5px; font-weight: 600;">Priority</label>
                <select [(ngModel)]="newTicket.priority"
                    style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd;">
                    <option value="Low">Low</option>
                    <option value="Medium">Medium</option>
                    <option value="High">High</option>
                </select>
            </div>
        </div>
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Message</label>
            <textarea [(ngModel)]="newTicket.message" rows="4" placeholder="Describe your issue..."
                style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd;"></textarea>
        </div>
        <div style="display: flex; gap: 10px;">
            <button class="btn-3d" (click)="submitTicket()">Submit Ticket</button>
            <button class="btn-3d" style="background: #ccc;" (click)="toggleCreate()">Cancel</button>
        </div>
    </div>

    <div class="tickets-table-3d">
        <div class="table-header">
            <div class="col">Ticket ID</div>
            <div class="col">Title</div>
            <div class="col">Priority</div>
            <div class="col">Status</div>
            <div class="col">Created</div>
            <div class="col">Replies</div>
        </div>

        <div *ngFor="let ticket of tickets" class="table-row">
            <div class="col" title="{{ ticket.id }}">{{ ticket.id.substring(0,8) }}</div>
            <div class="col">{{ ticket.title }}</div>
            <div class="col">
                <span class="priority-badge" [class]="ticket.priority.toLowerCase()">{{ ticket.priority }}</span>
            </div>
            <div class="col">
                <span class="status-badge" [class]="ticket.status.toLowerCase()">{{ ticket.status }}</span>
            </div>
            <div class="col">{{ ticket.creationTime | date: 'MMM d, y h:mm a' }}</div>
            <div class="col">
                <span *ngIf="ticket.adminRemarks" class="replied-badge">Yes</span>
                <span *ngIf="!ticket.adminRemarks">No</span>
            </div>
        </div>
    </div>
</div>